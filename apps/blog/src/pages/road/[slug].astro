---
import { getCollection, render } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import { useTranslations } from "../../i18n";
import Callout from "../../components/mdx/Callout";

export async function getStaticPaths() {
  const roads = await getCollection("roads");
  return roads.map((road) => {
    const slug = road.id.replace(/\//g, "-").replace(/\.mdx?$/, "");
    return { params: { slug }, props: { road } };
  });
}

const { road } = Astro.props;
const locale = "ko";
const t = useTranslations(locale);

const { Content } = await render(road);
---

<BaseLayout
  title={road.data.title}
  canonicalUrl={`https://jgjgill.com/road/${Astro.params.slug}`}
>
  <article>
    <header class="mb-8">
      <p class="text-sm text-muted mb-2">{road.data.date}</p>
      <h1 class="text-2xl font-bold leading-snug">{road.data.title}</h1>
    </header>

    <div class="prose">
      <Content components={{ Callout }} />
    </div>

    <footer class="mt-12 pt-6 border-t border-border">
      <a
        href="/road"
        class="text-sm text-muted hover:text-fg transition-colors"
      >
        ‚Üê {t.common.backToList}
      </a>
    </footer>
  </article>
</BaseLayout>
